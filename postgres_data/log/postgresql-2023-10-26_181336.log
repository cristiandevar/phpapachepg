2023-10-26 18:13:36.116 UTC [1] LOG:  starting PostgreSQL 16.0 on x86_64-pc-linux-musl, compiled by gcc (Alpine 12.2.1_git20220924-r10) 12.2.1 20220924, 64-bit
2023-10-26 18:13:36.116 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
2023-10-26 18:13:36.116 UTC [1] LOG:  listening on IPv6 address "::", port 5432
2023-10-26 18:13:36.152 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-10-26 18:13:36.448 UTC [25] LOG:  database system was interrupted; last known up at 2023-10-26 17:58:41 UTC
2023-10-26 18:13:46.482 UTC [25] LOG:  syncing data directory (pre-fsync), elapsed time: 10.00 s, current path: ./base/16384/3395
2023-10-26 18:13:56.480 UTC [25] LOG:  syncing data directory (pre-fsync), elapsed time: 20.00 s, current path: ./base/16598/2615
2023-10-26 18:14:06.499 UTC [25] LOG:  syncing data directory (pre-fsync), elapsed time: 30.02 s, current path: ./base/41188/2620
2023-10-26 18:14:16.485 UTC [25] LOG:  syncing data directory (pre-fsync), elapsed time: 40.00 s, current path: ./pg_logical/replorigin_checkpoint
2023-10-26 18:14:26.845 UTC [25] LOG:  syncing data directory (fsync), elapsed time: 10.00 s, current path: ./base/16598/5002
2023-10-26 18:14:36.840 UTC [25] LOG:  syncing data directory (fsync), elapsed time: 20.00 s, current path: ./pg_logical/mappings
2023-10-26 18:14:37.360 UTC [25] LOG:  database system was not properly shut down; automatic recovery in progress
2023-10-26 18:14:37.638 UTC [25] LOG:  redo starts at 0/73951D8
2023-10-26 18:14:37.642 UTC [25] LOG:  invalid record length at 0/73952C0: expected at least 24, got 0
2023-10-26 18:14:37.642 UTC [25] LOG:  redo done at 0/7395288 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2023-10-26 18:14:37.939 UTC [23] LOG:  checkpoint starting: end-of-recovery immediate wait
2023-10-26 18:14:38.245 UTC [23] LOG:  checkpoint complete: wrote 3 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.080 s, sync=0.030 s, total=0.318 s; sync files=2, longest=0.018 s, average=0.015 s; distance=0 kB, estimate=0 kB; lsn=0/73952C0, redo lsn=0/73952C0
2023-10-26 18:14:38.287 UTC [1] LOG:  database system is ready to accept connections
2023-10-26 18:20:17.153 UTC [32] ERROR:  could not compile PL/Python function "f_impide_orden_china"
2023-10-26 18:20:17.153 UTC [32] DETAIL:  SyntaxError: invalid syntax (<string>, line 8)
2023-10-26 18:20:17.153 UTC [32] STATEMENT:  /*
	 * 2. Realizar un disparador que impida crear una orden a un cliente de China.
	 * */
	create or replace function f_impide_orden_china()
	returns trigger as 
	$$
	query = """select country from customers where customerid="""
	query += TD["new"]["customerid"]
	query += ";"
	resultado = plpy.execute(query)
	pais = resultado[0]["country"]
	IF pais != 'China':
		RETURN "MODIFY"
	plpy.notice("No se pudo realizar: " + TD["event"] + ", dado que customerid corresponde a cliente del pais: " + pais)
	return "SKIP"
	$$
	language plpython3u
2023-10-26 18:20:28.171 UTC [32] ERROR:  could not compile PL/Python function "f_impide_orden_china"
2023-10-26 18:20:28.171 UTC [32] DETAIL:  SyntaxError: invalid syntax (<string>, line 8)
2023-10-26 18:20:28.171 UTC [32] STATEMENT:  /*
	 * 2. Realizar un disparador que impida crear una orden a un cliente de China.
	 * */
	create or replace function f_impide_orden_china()
	returns trigger as 
	$$
	query = """select country from customers where customerid="""
	query += TD["new"]["customerid"]
	query += ";"
	resultado = plpy.execute(query)
	pais = resultado[0]["country"]
	IF pais != 'China':
		return "MODIFY"
	plpy.notice("No se pudo realizar: " + TD["event"] + ", dado que customerid corresponde a cliente del pais: " + pais)
	return "SKIP"
	$$
	language plpython3u
2023-10-26 18:24:04.497 UTC [32] ERROR:  column "faz" of relation "orders" does not exist at character 65
2023-10-26 18:24:04.497 UTC [32] STATEMENT:  insert into orders(
		orderdate,
		customerid ,
		netamount ,
		faz,
		totalamount 
	)
	values(
		'2023-10-26',
		10023,
		1,
		1,
		1
	)
2023-10-26 18:24:13.583 UTC [32] ERROR:  column "fax" of relation "orders" does not exist at character 65
2023-10-26 18:24:13.583 UTC [32] STATEMENT:  insert into orders(
		orderdate,
		customerid ,
		netamount ,
		fax,
		totalamount 
	)
	values(
		'2023-10-26',
		10023,
		1,
		1,
		1
	)
2023-10-26 18:24:37.458 UTC [23] LOG:  checkpoint starting: time
2023-10-26 18:24:38.421 UTC [23] LOG:  checkpoint complete: wrote 8 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.776 s, sync=0.026 s, total=0.964 s; sync files=6, longest=0.014 s, average=0.005 s; distance=48 kB, estimate=48 kB; lsn=0/73A13C8, redo lsn=0/73A1390
2023-10-26 18:25:15.002 UTC [32] ERROR:  TypeError: can only concatenate str (not "int") to str
2023-10-26 18:25:15.002 UTC [32] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "f_impide_orden_china", line 3, in <module>
	    query += TD["new"]["customerid"]
	PL/Python function "f_impide_orden_china"
2023-10-26 18:25:15.002 UTC [32] STATEMENT:  insert into orders(
		orderdate,
		customerid ,
		netamount ,
		tax,
		totalamount 
	)
	values(
		'2023-10-26',
		10023,
		1,
		1,
		1
	)
2023-10-26 18:25:17.821 UTC [32] ERROR:  TypeError: can only concatenate str (not "int") to str
2023-10-26 18:25:17.821 UTC [32] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "f_impide_orden_china", line 3, in <module>
	    query += TD["new"]["customerid"]
	PL/Python function "f_impide_orden_china"
2023-10-26 18:25:17.821 UTC [32] STATEMENT:  insert into orders(
		orderdate,
		customerid ,
		netamount ,
		tax,
		totalamount 
	)
	values(
		'2023-10-26',
		10023,
		1,
		1,
		1
	)
2023-10-26 18:29:37.530 UTC [23] LOG:  checkpoint starting: time
2023-10-26 18:29:39.037 UTC [23] LOG:  checkpoint complete: wrote 13 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=1.303 s, sync=0.043 s, total=1.508 s; sync files=11, longest=0.013 s, average=0.004 s; distance=66 kB, estimate=66 kB; lsn=0/73B1E08, redo lsn=0/73B1DD0
